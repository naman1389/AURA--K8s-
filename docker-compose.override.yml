services:
  # Disable collector (needs K8s cluster)
  collector:
    profiles:
      - disabled

  # Disable remediator (needs K8s cluster)  
  remediator:
    profiles:
      - disabled

  # Fix Ollama health check - give it time to download and load model
  ollama:
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:11434/api/tags || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 300s  # 5 minutes for model loading

  # Make orchestrator independent of MCP (MCP is optional)
  orchestrator:
    depends_on:
      timescaledb:
        condition: service_healthy
      ml-service:
        condition: service_healthy
      # Removed mcp-server dependency

  # Make MCP server start independently
  mcp-server:
    depends_on:
      timescaledb:
        condition: service_healthy
      # Removed ollama dependency - will handle offline gracefully
